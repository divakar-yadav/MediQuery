{
    "title": "Robust and fast characterization of OCT-based optical attenuation using a novel frequency-domain algorithm for brain cancer detection",
    "abstract": "where z is the imaging depth, z0 is the surface of the sample, A is an overall system constant, \u03bcbs is the back-scattering coefficient, \u03bcext is the total optical attenuation (extinction) coefficient, and h(z) is the point spread function describing the focusing/de-focusing effect of the beam in a turbid medium (e.g., biological tissue). For accurate assessment of the attenuation properties, we developed a method to mitigate the influence of the depth-dependent effects of the beam profiles as described previously19, where the OCT signal from the sample of interest Is(z) was normalized with the one from a reference silica phantom Ir(z) with a known attenuation coefficient (see Supplementary Information). For accurate assessment of the attenuation properties, we developed a method to mitigate the influence of the depth-dependent effects of the beam profiles as described previously19, where the OCT signal from the sample of interest Is(z) was normalized with the one from a reference silica phantom Ir(z) with a known attenuation coefficient (see Supplementary Information).",
    "authors": [
        "Wu Yuan",
        "Carmen Kut",
        "Wenxuan Liang",
        "Xingde Li"
    ],
    "published_year": "2017",
    "description": "Methods\n      \n        FD Algorithm\n        It is well known that the depth-dependent OCT intensity signal Ioct(z) can be written as:222324\n        \n          \n            \n          \n        \n        where z is the imaging depth, z0 is the surface of the sample, A is an overall system constant, \u03bcbs is the back-scattering coefficient, \u03bcext is the total optical attenuation (extinction) coefficient, and h(z) is the point spread function describing the focusing/de-focusing effect of the beam in a turbid medium (e.g., biological tissue).\n        For accurate assessment of the attenuation properties, we developed a method to mitigate the influence of the depth-dependent effects of the beam profiles as described previously19, where the OCT signal from the sample of interest Is(z) was normalized with the one from a reference silica phantom Ir(z) with a known attenuation coefficient (see Supplementary Information). When assuming the same z0\u2009=\u20090 for both OCT signals, the following depth-dependent function (termed as normalized OCT intensity) with a single exponential decay starting from the sample surface can be obtained:\n        \n          \n            \n          \n        \n        After taking the Fourier transform of equation (2) and some algebra, the optical attenuation coefficient can be derived by comparing the amplitude of any two harmonic coefficients in the Fourier domain, such as by taking the ratio of the direct current (DC) component with the modulus of the first harmonic coefficient, i.e.:\n        \n          \n            \n          \n        \n        where \u03ba is the frequency in space, \u0394z is the pixel size along depth, and N is the total number of data points (i.e., pixels) per A-line. This FD method was inspired by the frequency domain method for computing fluorescence lifetime25. For a given discrete A-line data, i.e., I(n\u00b7\u0394z), the amplitude of any harmonic coefficients (denoted by the order m) is computed by the following discrete Fourier transform (which is intrinsically extremely fast):\n        \n          \n            \n          \n        \n        Here  is the fundamental spatial frequency, and n\u2009=\u20090 to N\u2009\u2212\u20091 represents the sequential index of the given discrete A-line. To summarize, we can use this new FD method and readily apply discrete Fourier transform to the discrete A-line data to calculate the amplitudes of any two harmonics, obtain the relative attenuation coefficient term, i.e., , and finally, extract the optical attenuation coefficient of the sample, i.e., , given the known attenuation of the reference phantom .\n        Alternatively, an iterative exponential fitting process with a trust-region algorithm26, i.e., the traditional EF method, can be applied to equation (2) to extract the relative attenuation coefficient  from which the sample attenuation coefficient  can be readily obtained13. LF method, on the other hand, uses the logarithm of equation (2) to achieve a linear equation and then  can be derived from the slope of the linear equation by using the simple linear regression algorithm (linear least squares method, see Supplementary Information)15161921.\n      \n      \n        SS-OCT System\n        In order to quantitatively evaluate the ultrafast FD method, an SS-OCT system was used to acquire datasets from the reference silica phantom and from a freshly resected human brain cancer sample. The SS-OCT system is equipped with a home-built FDML swept source which operates at 220\u2009kHz and a center wavelength of 1310\u2009nm with a 3\u2009dB bandwidth of \u223c110\u2009nm and a full bandwidth of \u223c150\u2009nm. A handheld probe with an x-y galvanometer was used to perform 2D beam scanning. The power incident on the samples was about 15\u2009mW. Measured lateral and axial resolutions are \u223c16.0\u2009\u03bcm and \u223c6.4\u2009\u03bcm (in tissue), respectively. A detection sensitivity of \u223c126\u2009dB was achieved.\n      \n      \n        Images Acquisition and Processing\n        For both the silica phantom and human brain cancer tissue, we acquired OCT data over a 2\u2009mm\u2009\u00d7\u20092\u2009mm\u2009\u00d7\u20091.8\u2009mm (x\u2009\u00d7\u2009y\u2009\u00d7\u2009z) volume. This produced three-dimensional datasets with 2048 data points/A-line\u2009\u00d7\u20092048 A-lines/frame\u2009\u00d7\u2009256 frames. To obtain a color-coded attenuation map, we reduced the speckle noise by averaging approximately \u223c330 A-lines along the x-direction, with a window step size of \u223c13 A-lines. After that, an automatic algorithm was implemented to locate the sample surface for each averaged OCT intensity signal Is(z) (tissue and sample phantom) and Ir(z) (reference phantom). Using the identified sample surface as the starting data point in the z-direction, we compute the optical attenuation coefficient with an appropriate data length (\u223c350 vs. \u223c700\u2009\u03bcm) by using the EF, FD, and LF methods. In other words, optical attenuation properties were computed for each voxel of 0.33\u2009mm\u2009\u00d7\u20090.008\u2009mm\u2009\u00d7\u20091.8\u2009mm (x, y, and z) within the volumetric images with a step size of 0.013\u2009mm in the x-direction and 0.008\u2009mm in the y-direction.The imaging protocol for human tissues study was approved by the Institutional Review Board at Johns Hopkins University.\nFD Algorithm\n        It is well known that the depth-dependent OCT intensity signal Ioct(z) can be written as:222324\n        \n          \n            \n          \n        \n        where z is the imaging depth, z0 is the surface of the sample, A is an overall system constant, \u03bcbs is the back-scattering coefficient, \u03bcext is the total optical attenuation (extinction) coefficient, and h(z) is the point spread function describing the focusing/de-focusing effect of the beam in a turbid medium (e.g., biological tissue).\n        For accurate assessment of the attenuation properties, we developed a method to mitigate the influence of the depth-dependent effects of the beam profiles as described previously19, where the OCT signal from the sample of interest Is(z) was normalized with the one from a reference silica phantom Ir(z) with a known attenuation coefficient (see Supplementary Information). When assuming the same z0\u2009=\u20090 for both OCT signals, the following depth-dependent function (termed as normalized OCT intensity) with a single exponential decay starting from the sample surface can be obtained:\n        \n          \n            \n          \n        \n        After taking the Fourier transform of equation (2) and some algebra, the optical attenuation coefficient can be derived by comparing the amplitude of any two harmonic coefficients in the Fourier domain, such as by taking the ratio of the direct current (DC) component with the modulus of the first harmonic coefficient, i.e.:\n        \n          \n            \n          \n        \n        where \u03ba is the frequency in space, \u0394z is the pixel size along depth, and N is the total number of data points (i.e., pixels) per A-line. This FD method was inspired by the frequency domain method for computing fluorescence lifetime25. For a given discrete A-line data, i.e., I(n\u00b7\u0394z), the amplitude of any harmonic coefficients (denoted by the order m) is computed by the following discrete Fourier transform (which is intrinsically extremely fast):\n        \n          \n            \n          \n        \n        Here  is the fundamental spatial frequency, and n\u2009=\u20090 to N\u2009\u2212\u20091 represents the sequential index of the given discrete A-line. To summarize, we can use this new FD method and readily apply discrete Fourier transform to the discrete A-line data to calculate the amplitudes of any two harmonics, obtain the relative attenuation coefficient term, i.e., , and finally, extract the optical attenuation coefficient of the sample, i.e., , given the known attenuation of the reference phantom .\n        Alternatively, an iterative exponential fitting process with a trust-region algorithm26, i.e., the traditional EF method, can be applied to equation (2) to extract the relative attenuation coefficient  from which the sample attenuation coefficient  can be readily obtained13. LF method, on the other hand, uses the logarithm of equation (2) to achieve a linear equation and then  can be derived from the slope of the linear equation by using the simple linear regression algorithm (linear least squares method, see Supplementary Information)15161921.\nSS-OCT System\n        In order to quantitatively evaluate the ultrafast FD method, an SS-OCT system was used to acquire datasets from the reference silica phantom and from a freshly resected human brain cancer sample. The SS-OCT system is equipped with a home-built FDML swept source which operates at 220\u2009kHz and a center wavelength of 1310\u2009nm with a 3\u2009dB bandwidth of \u223c110\u2009nm and a full bandwidth of \u223c150\u2009nm. A handheld probe with an x-y galvanometer was used to perform 2D beam scanning. The power incident on the samples was about 15\u2009mW. Measured lateral and axial resolutions are \u223c16.0\u2009\u03bcm and \u223c6.4\u2009\u03bcm (in tissue), respectively. A detection sensitivity of \u223c126\u2009dB was achieved.\nImages Acquisition and Processing\n        For both the silica phantom and human brain cancer tissue, we acquired OCT data over a 2\u2009mm\u2009\u00d7\u20092\u2009mm\u2009\u00d7\u20091.8\u2009mm (x\u2009\u00d7\u2009y\u2009\u00d7\u2009z) volume. This produced three-dimensional datasets with 2048 data points/A-line\u2009\u00d7\u20092048 A-lines/frame\u2009\u00d7\u2009256 frames. To obtain a color-coded attenuation map, we reduced the speckle noise by averaging approximately \u223c330 A-lines along the x-direction, with a window step size of \u223c13 A-lines. After that, an automatic algorithm was implemented to locate the sample surface for each averaged OCT intensity signal Is(z) (tissue and sample phantom) and Ir(z) (reference phantom). Using the identified sample surface as the starting data point in the z-direction, we compute the optical attenuation coefficient with an appropriate data length (\u223c350 vs. \u223c700\u2009\u03bcm) by using the EF, FD, and LF methods. In other words, optical attenuation properties were computed for each voxel of 0.33\u2009mm\u2009\u00d7\u20090.008\u2009mm\u2009\u00d7\u20091.8\u2009mm (x, y, and z) within the volumetric images with a step size of 0.013\u2009mm in the x-direction and 0.008\u2009mm in the y-direction.The imaging protocol for human tissues study was approved by the Institutional Review Board at Johns Hopkins University.\nResults\n      \n        Comparison of Robustness against the Few-scattering Effect\n        It is well-known that as light propagates, the probability of few-scattering in a turbid medium increases exponentially with the penetration depth and the attenuation coefficient according to 22. While all three methods (FD, LF and EF) are based on a single-scattering model, we know that few-scattering occurs in real-life conditions. Thus, we have evaluated the robustness of all three algorithms against the few-scattering effect, as demonstrated in Fig. 1(A,B).\n        To conduct this test, we acquired OCT signals from freshly resected human brain tissues and obtained normalized OCT intensity signals at regions with low (\u223c3\u2009mm\u22121), medium (\u223c5\u2009mm\u22121) and high (\u223c7\u2009mm\u22121) attenuation coefficients (as shown in Fig. 1(A)). Notably, 300-A-lines within the same frame was averaged to achieve the OCT intensity signal before the normalization with the corresponding averaged intensity signal from the reference phantom.\n        Using the same normalized OCT intensity signals, we then evaluate the robustness of all 3 methods as the probability of few-scattering increases. In this test, we increase the probability of few-scattering by 1) increasing the data length (in the z-direction) used to compute the sample attenuation coefficient ; and 2) by using a region of interest with higher attenuation. As shown in Fig. 1(B), the EF method yielded the most consistent computations of attenuation coefficients for all regions of interests and at different data lengths. As expected, the EF method is the most robust against the few-scattering effect, despite its low computational efficiency. Therefore, we treat results from the EF method as the gold standard in subsequent evaluations of the FD and LF methods.\n        When a region of interest has a low attenuation coefficient at \u223c3\u2009mm\u22121 (i.e., with low few-scattering effects), we found that FD, LF and EF provided comparable results even when data lengths increased. When the attenuation coefficient increased to the medium level of \u223c5\u2009mm\u22121 (i.e., with medium few-scattering effects), results from the LF method deviated significantly from the EF method as the data length increases, while the FD method provided comparable results to the EF method. Finally, when the attenuation coefficient is high (i.e., \u223c7\u2009mm\u22121), the LF method was severely influenced by the few-scattering effect, with \u223c35% reduction in the attenuation coefficient at a data length of \u223c1050\u2009\u03bcm (which corresponds to \u223c7.3 mean free paths). In comparison, FD method was only moderately affected by the increasing few-scattering effect (with a \u223c 20% reduction in the attenuation coefficient). Thus, we find that the FD method is more robust against the few-scattering effect when compared with the LF method. This feature can be very important and ensures data reliability when obtaining quantitative attenuation properties.\n      \n      \n        Comparison of Robustness against Incorrect Tissue Surface Detection\n        Then we compared the robustness of all three methods when tissue surface detection is inaccurate. As shown in Fig. 1(A), we used the same imaged region (with 300 A-lines) and calculated the normalized average sample intensity signal I(z) when the tissue surface detection is accurate (i.e., the blue line with the low attenuation coefficient at \u223c3\u2009mm\u22121), and again when the tissue surface detection is inaccurate (i.e., the magenta line as shown in the figure). Here, we intentionally select a region with a low attenuation coefficient for comparison (as a tissue region with high attenuation coefficient already suffers significantly from the few-scattering effect which will mask the true effects of incorrect surface detection).\n        As seen in Fig. 1(C), when tissue surface detection is inaccurate, both the EF and LF methods exhibited a pronounced deviation from the true attenuation coefficient (\u223c3\u2009mm\u22121). In fact, even negative attenuation coefficients were found when computed using the EF and LF methods. As an example, the incorrect surface detection leaded to a wrongly fitted line with the LF method (green line), as shown in the inset of Fig. 1(C), and resulted in a negative attenuation coefficient (green circle in Fig. 1(C)). In contrast, the FD method is significantly robust against the effects of incorrect tissue surface detection and produced attenuation coefficients which are closer to its true value at \u223c3\u2009mm\u22121. Such robustness from the FD method is consistent with our theoretical predictions as detailed in Supplementary Information, where we show that an incorrect detection of the sample surface, i.e., z0, has no effect on our attenuation computations with the FD method. As a result, the FD method is especially desirable for in vivo and high-speed applications, where the experimental subject often exhibits complex surface geometry and motions as a result of breathing, heart beat and other bodily movements. Since the FD method eliminates the need for accurate surface detection, it is consequently very useful in minimizing motion errors and achieving clinically meaningful conclusions in real time during a clinical or experimental procedure.\n      \n      \n        Comparison of Computational Efficiencies\n        Furthermore, to quantitatively compare the computational efficiencies of the FD, LF and EF methods, a benchmark test was performed using a phantom dataset with approximately 524,000 A-lines (2048 A-lines/frame \u00d7 256 frames, and 2,048 pixels/A-line). Central processing unit (CPU) timing was carried out on a personal computer with a Windows 7 operating system, an Intel Core i5-4570 at a base processor frequency of 3.2\u2009GHz and a maximum graphics memory of 2\u2009GB. Algorithms were implemented in MATLAB (The MathWorks Inc.). Computational time was measured for all 3 methods. As shown in the benchmark results in Fig. 1(D), we found that the FD method takes 2.38\u2009msec per frame and the LF method takes 2.51\u2009msec per frame when compared to the EF method which takes 44.92\u2009msec per frame. To summarize, the FD method offers a speed slightly better than the LF method, but much faster (approximately 22 times) than the EF method.\n        To more precisely understand the computational efficiencies of the FD and LF methods in real-time scenarios, we performed an additional benchmark test to study the GPU timing between these two methods. GPU timing was performed using an NVIDIA GeForce GTX 760 with 1152 CUDA cores, a base clock at 0.98\u2009GHz, and a memory speed of 6.0\u2009GB per second. Algorithms were implemented in CUDA C/C++ using the same personal computer. A dataset of the same size as above was used. As shown in the benchmark results in the inset of Fig. 1(D), the GPU version of the FD method (0.27\u2009msec per frame) offers an approximately \u223c15% speedup when compared with the LF method (0.32\u2009msec per frame). This speedup is likely due to the fact that the FD method relies on CUDA computation of 3 key parameters: , ,  (as shown in equation (4)), while the LF method relies on CUDA computation of 4 key parameters for the simple linear regression (linear least squares) algorithm: , , , and  (see Supplementary Information for the explanation of these terms, as shown in the simple linear regression (linear least squares) algorithm). To summarize, the FD method utilizes less shared memory in CUDA, requires fewer CUDA computations, and as a result, enjoys a slightly reduced computational time when compared with the LF method.\n        Notably, only the computational times for the FD and LF methods were included in the above GPU benchmark test. Times for other supporting algorithms (e.g., loading of OCT intensity data, speckle suppression/data averaging, and surface detection) were identical for both methods, and as a result, were not included in the above analysis.\n      \n      \n        Comparison of Robustness against Speckle Noise Levels\n        Finally, to evaluate the robustness of all 3 methods against speckle noise, we compared the average intensity signals from a region of interest containing 300 A-lines versus 50 A-lines (within the same frame). Our results showed that all 3 methods enjoyed comparable robustness to speckle noise. Using the FD method, there is approximately 8% change in the computed attenuation when averaged with 50 A-lines (versus 300 A-lines). Using the EF and LF methods, there are respectively \u223c10% and \u223c13% changes in the computed attenuation when averaged with 50 A-lines (versus 300 A-lines).\n      \n      \n        Validation of the FD Method with Phantoms\n        We firstly obtained OCT images for two test phantoms: phantom R made with 5% gelatin embedded with 12.5\u2009mg/mL silica nanospheres, and phantom S made with 5% gelatin and 50\u2009mg/mL silica nanospheres (which is more heterogeneously distributed). Using phantom R as reference and phantom S as our sample, we validated our results by comparing the measured optical properties of phantom S with the analytically calculated values of the same phantom using Mie theory. Figure 2 illustrates the en face color-coded optical attenuation maps of phantom S obtained with the EF, FD and LF methods with a data length of \u223c350\u2009\u03bcm. Here, we find that the three methods achieved comparable attenuation maps; if we subtract the colormaps in Fig. 2(A) by the map in Fig. 2(D), the change in attenuation coefficients \u0394\u03bc is roughly 0.01\u2009\u00b1\u20090.25\u2009mm\u22121, while \u0394\u03bc is about 0.01\u2009\u00b1\u20090.18\u2009mm\u22121 between the colormaps in Fig. 2(D,G). However, when a longer data length (i.e., \u223c700\u2009\u03bcm) along the z-direction was used, the change in attenuation \u0394\u03bc in Fig. 2(E) vs. 2(H) increased to 0.04\u2009\u00b1\u20090.14\u2009mm\u22121, while a relatively small change of 0.01\u2009\u00b1\u20090.32\u2009mm\u22121 in attenuation \u0394\u03bc was found between Fig. 2(B,E). Most notably, the LF method using the data length of \u223c700\u2009\u03bcm (Fig. 2(H)) yielded the most inconsistent results, as the green band at the top of the image (signifying high attenuation, with the band boundary determined by a threshold of 3.75\u2009mm\u22121) is much smaller and with an \u223c35% reduction in width when compared with the other attenuation maps (Fig. 2(A,B,D,E and G)). This suggested that the LF method is more susceptible to the increasing influence of few-scattering effect as the data length increases. In contrast, the FD method produced a relatively robust attenuation coefficient map which is more comparable with that generated by the EF method, regardless of the data length. Finally, the corresponding volumetric OCT images with an overlaid attenuation en face colormaps were shown in Fig. 2(C,F and I) for the EF, FD, and LF methods with the data length of \u223c700\u2009\u03bcm, respectively.\n      \n      \n        Validation of the FD Method for Brain Cancer Detection\n        To further illustrate the feasibility of our FD method, we obtained a freshly resected human brain cancer tissue sample from a grade IV glioma patient (i.e., glioblastoma). Before imaging, the tissue sample was marked with a yellow margin marking dye (MasterTech) for histological registration and correlation. After imaging, the tissue samples were placed in formalin overnight and then submitted for histological processing. Standard histological slide were obtained and correlated with the attenuation colormaps. Histological interpretation was made independently by a neuro-pathologist who reviewed the histological slides in a blinded study. As shown in Fig. 3, the attenuation colormaps were obtained using the FD and LF methods and subsequently correlated and validated by histology. To obtain the attenuation coefficients, an averaging window of \u223c330 A-lines was used with a step size of \u223c13 A-lines (along the x-direction), and a data length of \u223c350\u2009\u03bcm was applied along the z-direction.\n        Our previous study established an optimal attenuation threshold at 5.5\u2009mm\u22121 for distinguishing infiltrative brain cancer margins with high sensitivity and specificity21. The same study also found that non-cancer white matter had a significantly higher attenuation when compared with primary brain cancer;21 this is because of the high myelin content and lack of necrosis in normal white matter which was well-reported in previous literature212728. Using this diagnostic attenuation threshold, the optical attenuation map of an ex vivo human brain sample can be color-coded to clearly show the infiltrative cancer margins. As shown in Fig. 3, low optical attenuation (red) represents areas with high cancer density; medium optical attenuation (yellow) represents areas with medium cancer density; and high optical attenuation (green) represents areas with low cancer density (i.e., the tissue consists of mostly white matter, with diffuse infiltration of some neoplastic components). In the earlier study we have validated the LF method in delineating ex vivo human brain cancer versus non-cancer in real time21. Our results in Fig. 3 further demonstrate that the FD method is able to achieve comparable results as the LF method in detecting human brain cancer infiltration. Histological validation is provided in Fig. 3(C), with zoomed-in views corresponding to areas of low cancer density (Fig. 3(D)) and areas of high cancer density (Fig. 3(E)). The color-coded optical attenuation map (generated by the FD method) correlates well with histology, which further illustrates the feasibility of the FD method in human brain cancer detection.\nComparison of Robustness against the Few-scattering Effect\n        It is well-known that as light propagates, the probability of few-scattering in a turbid medium increases exponentially with the penetration depth and the attenuation coefficient according to 22. While all three methods (FD, LF and EF) are based on a single-scattering model, we know that few-scattering occurs in real-life conditions. Thus, we have evaluated the robustness of all three algorithms against the few-scattering effect, as demonstrated in Fig. 1(A,B).\n        To conduct this test, we acquired OCT signals from freshly resected human brain tissues and obtained normalized OCT intensity signals at regions with low (\u223c3\u2009mm\u22121), medium (\u223c5\u2009mm\u22121) and high (\u223c7\u2009mm\u22121) attenuation coefficients (as shown in Fig. 1(A)). Notably, 300-A-lines within the same frame was averaged to achieve the OCT intensity signal before the normalization with the corresponding averaged intensity signal from the reference phantom.\n        Using the same normalized OCT intensity signals, we then evaluate the robustness of all 3 methods as the probability of few-scattering increases. In this test, we increase the probability of few-scattering by 1) increasing the data length (in the z-direction) used to compute the sample attenuation coefficient ; and 2) by using a region of interest with higher attenuation. As shown in Fig. 1(B), the EF method yielded the most consistent computations of attenuation coefficients for all regions of interests and at different data lengths. As expected, the EF method is the most robust against the few-scattering effect, despite its low computational efficiency. Therefore, we treat results from the EF method as the gold standard in subsequent evaluations of the FD and LF methods.\n        When a region of interest has a low attenuation coefficient at \u223c3\u2009mm\u22121 (i.e., with low few-scattering effects), we found that FD, LF and EF provided comparable results even when data lengths increased. When the attenuation coefficient increased to the medium level of \u223c5\u2009mm\u22121 (i.e., with medium few-scattering effects), results from the LF method deviated significantly from the EF method as the data length increases, while the FD method provided comparable results to the EF method. Finally, when the attenuation coefficient is high (i.e., \u223c7\u2009mm\u22121), the LF method was severely influenced by the few-scattering effect, with \u223c35% reduction in the attenuation coefficient at a data length of \u223c1050\u2009\u03bcm (which corresponds to \u223c7.3 mean free paths). In comparison, FD method was only moderately affected by the increasing few-scattering effect (with a \u223c 20% reduction in the attenuation coefficient). Thus, we find that the FD method is more robust against the few-scattering effect when compared with the LF method. This feature can be very important and ensures data reliability when obtaining quantitative attenuation properties.\nComparison of Robustness against Incorrect Tissue Surface Detection\n        Then we compared the robustness of all three methods when tissue surface detection is inaccurate. As shown in Fig. 1(A), we used the same imaged region (with 300 A-lines) and calculated the normalized average sample intensity signal I(z) when the tissue surface detection is accurate (i.e., the blue line with the low attenuation coefficient at \u223c3\u2009mm\u22121), and again when the tissue surface detection is inaccurate (i.e., the magenta line as shown in the figure). Here, we intentionally select a region with a low attenuation coefficient for comparison (as a tissue region with high attenuation coefficient already suffers significantly from the few-scattering effect which will mask the true effects of incorrect surface detection).\n        As seen in Fig. 1(C), when tissue surface detection is inaccurate, both the EF and LF methods exhibited a pronounced deviation from the true attenuation coefficient (\u223c3\u2009mm\u22121). In fact, even negative attenuation coefficients were found when computed using the EF and LF methods. As an example, the incorrect surface detection leaded to a wrongly fitted line with the LF method (green line), as shown in the inset of Fig. 1(C), and resulted in a negative attenuation coefficient (green circle in Fig. 1(C)). In contrast, the FD method is significantly robust against the effects of incorrect tissue surface detection and produced attenuation coefficients which are closer to its true value at \u223c3\u2009mm\u22121. Such robustness from the FD method is consistent with our theoretical predictions as detailed in Supplementary Information, where we show that an incorrect detection of the sample surface, i.e., z0, has no effect on our attenuation computations with the FD method. As a result, the FD method is especially desirable for in vivo and high-speed applications, where the experimental subject often exhibits complex surface geometry and motions as a result of breathing, heart beat and other bodily movements. Since the FD method eliminates the need for accurate surface detection, it is consequently very useful in minimizing motion errors and achieving clinically meaningful conclusions in real time during a clinical or experimental procedure.\nComparison of Computational Efficiencies\n        Furthermore, to quantitatively compare the computational efficiencies of the FD, LF and EF methods, a benchmark test was performed using a phantom dataset with approximately 524,000 A-lines (2048 A-lines/frame \u00d7 256 frames, and 2,048 pixels/A-line). Central processing unit (CPU) timing was carried out on a personal computer with a Windows 7 operating system, an Intel Core i5-4570 at a base processor frequency of 3.2\u2009GHz and a maximum graphics memory of 2\u2009GB. Algorithms were implemented in MATLAB (The MathWorks Inc.). Computational time was measured for all 3 methods. As shown in the benchmark results in Fig. 1(D), we found that the FD method takes 2.38\u2009msec per frame and the LF method takes 2.51\u2009msec per frame when compared to the EF method which takes 44.92\u2009msec per frame. To summarize, the FD method offers a speed slightly better than the LF method, but much faster (approximately 22 times) than the EF method.\n        To more precisely understand the computational efficiencies of the FD and LF methods in real-time scenarios, we performed an additional benchmark test to study the GPU timing between these two methods. GPU timing was performed using an NVIDIA GeForce GTX 760 with 1152 CUDA cores, a base clock at 0.98\u2009GHz, and a memory speed of 6.0\u2009GB per second. Algorithms were implemented in CUDA C/C++ using the same personal computer. A dataset of the same size as above was used. As shown in the benchmark results in the inset of Fig. 1(D), the GPU version of the FD method (0.27\u2009msec per frame) offers an approximately \u223c15% speedup when compared with the LF method (0.32\u2009msec per frame). This speedup is likely due to the fact that the FD method relies on CUDA computation of 3 key parameters: , ,  (as shown in equation (4)), while the LF method relies on CUDA computation of 4 key parameters for the simple linear regression (linear least squares) algorithm: , , , and  (see Supplementary Information for the explanation of these terms, as shown in the simple linear regression (linear least squares) algorithm). To summarize, the FD method utilizes less shared memory in CUDA, requires fewer CUDA computations, and as a result, enjoys a slightly reduced computational time when compared with the LF method.\n        Notably, only the computational times for the FD and LF methods were included in the above GPU benchmark test. Times for other supporting algorithms (e.g., loading of OCT intensity data, speckle suppression/data averaging, and surface detection) were identical for both methods, and as a result, were not included in the above analysis.\nComparison of Robustness against Speckle Noise Levels\n        Finally, to evaluate the robustness of all 3 methods against speckle noise, we compared the average intensity signals from a region of interest containing 300 A-lines versus 50 A-lines (within the same frame). Our results showed that all 3 methods enjoyed comparable robustness to speckle noise. Using the FD method, there is approximately 8% change in the computed attenuation when averaged with 50 A-lines (versus 300 A-lines). Using the EF and LF methods, there are respectively \u223c10% and \u223c13% changes in the computed attenuation when averaged with 50 A-lines (versus 300 A-lines).\nValidation of the FD Method with Phantoms\n        We firstly obtained OCT images for two test phantoms: phantom R made with 5% gelatin embedded with 12.5\u2009mg/mL silica nanospheres, and phantom S made with 5% gelatin and 50\u2009mg/mL silica nanospheres (which is more heterogeneously distributed). Using phantom R as reference and phantom S as our sample, we validated our results by comparing the measured optical properties of phantom S with the analytically calculated values of the same phantom using Mie theory. Figure 2 illustrates the en face color-coded optical attenuation maps of phantom S obtained with the EF, FD and LF methods with a data length of \u223c350\u2009\u03bcm. Here, we find that the three methods achieved comparable attenuation maps; if we subtract the colormaps in Fig. 2(A) by the map in Fig. 2(D), the change in attenuation coefficients \u0394\u03bc is roughly 0.01\u2009\u00b1\u20090.25\u2009mm\u22121, while \u0394\u03bc is about 0.01\u2009\u00b1\u20090.18\u2009mm\u22121 between the colormaps in Fig. 2(D,G). However, when a longer data length (i.e., \u223c700\u2009\u03bcm) along the z-direction was used, the change in attenuation \u0394\u03bc in Fig. 2(E) vs. 2(H) increased to 0.04\u2009\u00b1\u20090.14\u2009mm\u22121, while a relatively small change of 0.01\u2009\u00b1\u20090.32\u2009mm\u22121 in attenuation \u0394\u03bc was found between Fig. 2(B,E). Most notably, the LF method using the data length of \u223c700\u2009\u03bcm (Fig. 2(H)) yielded the most inconsistent results, as the green band at the top of the image (signifying high attenuation, with the band boundary determined by a threshold of 3.75\u2009mm\u22121) is much smaller and with an \u223c35% reduction in width when compared with the other attenuation maps (Fig. 2(A,B,D,E and G)). This suggested that the LF method is more susceptible to the increasing influence of few-scattering effect as the data length increases. In contrast, the FD method produced a relatively robust attenuation coefficient map which is more comparable with that generated by the EF method, regardless of the data length. Finally, the corresponding volumetric OCT images with an overlaid attenuation en face colormaps were shown in Fig. 2(C,F and I) for the EF, FD, and LF methods with the data length of \u223c700\u2009\u03bcm, respectively.\nValidation of the FD Method for Brain Cancer Detection\n        To further illustrate the feasibility of our FD method, we obtained a freshly resected human brain cancer tissue sample from a grade IV glioma patient (i.e., glioblastoma). Before imaging, the tissue sample was marked with a yellow margin marking dye (MasterTech) for histological registration and correlation. After imaging, the tissue samples were placed in formalin overnight and then submitted for histological processing. Standard histological slide were obtained and correlated with the attenuation colormaps. Histological interpretation was made independently by a neuro-pathologist who reviewed the histological slides in a blinded study. As shown in Fig. 3, the attenuation colormaps were obtained using the FD and LF methods and subsequently correlated and validated by histology. To obtain the attenuation coefficients, an averaging window of \u223c330 A-lines was used with a step size of \u223c13 A-lines (along the x-direction), and a data length of \u223c350\u2009\u03bcm was applied along the z-direction.\n        Our previous study established an optimal attenuation threshold at 5.5\u2009mm\u22121 for distinguishing infiltrative brain cancer margins with high sensitivity and specificity21. The same study also found that non-cancer white matter had a significantly higher attenuation when compared with primary brain cancer;21 this is because of the high myelin content and lack of necrosis in normal white matter which was well-reported in previous literature212728. Using this diagnostic attenuation threshold, the optical attenuation map of an ex vivo human brain sample can be color-coded to clearly show the infiltrative cancer margins. As shown in Fig. 3, low optical attenuation (red) represents areas with high cancer density; medium optical attenuation (yellow) represents areas with medium cancer density; and high optical attenuation (green) represents areas with low cancer density (i.e., the tissue consists of mostly white matter, with diffuse infiltration of some neoplastic components). In the earlier study we have validated the LF method in delineating ex vivo human brain cancer versus non-cancer in real time21. Our results in Fig. 3 further demonstrate that the FD method is able to achieve comparable results as the LF method in detecting human brain cancer infiltration. Histological validation is provided in Fig. 3(C), with zoomed-in views corresponding to areas of low cancer density (Fig. 3(D)) and areas of high cancer density (Fig. 3(E)). The color-coded optical attenuation map (generated by the FD method) correlates well with histology, which further illustrates the feasibility of the FD method in human brain cancer detection.\nConclusion\n      In summary, we developed and validated a new generic, robust, and fast FD algorithm for quantifying tissue attenuation properties from OCT imaging data. Our experimental results demonstrated that the FD method is more robust than both the LF and EF methods when faced with incorrect tissue surface detection. Thus, the FD method is an attractive method which can address this significant real-world problem and provide an accurate attenuation calculation in real time during the surgical procedure. Furthermore, this new method is about 22 times faster than EF method, and is more robust against the effects of few-scattering when compared with the LF method. Our preliminary work shows the potential of this method for robust and fast OCT attenuation imaging/mapping, which is especially desirable for in vivo high-speed clinical applications, such as intraoperative brain cancer detection. More research will be carried out to further validate this new method for brain cancer tissue identification and qualification in vivo.\nAdditional Information\n      How to cite this article: Yuan, W. et al. Robust and fast characterization of OCT-based optical attenuation using a novel frequency-domain algorithm for brain cancer detection. Sci. Rep.\n7, 44909; doi: 10.1038/srep44909 (2017).\n      Publisher's note: Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nSupplementary Material\n      \n        \n          Supplementary Information\nhttps://www.ncbi.nlm.nih.gov/pmc/articles/PMC5361149/\nhttps://doi.org/10.1038/srep44909",
    "url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5361149/",
    "doi": "https://doi.org/10.1038/srep44909",
    "citation_count": 33,
    "references": {
        "10690309": "Automatic renal carcinoma biopsy guidance using forward-viewing endoscopic optical coherence tomography and deep learning",
        "10224110": "Signal-Decay Based Approach for Visualization of Buried Defects in 3-D Printed Ceramic Components Imaged with Help of Optical Coherence Tomography",
        "10017731": "Nondestructive label-free detection of peritumoral white matter damage using cross-polarization optical coherence tomography",
        "9947297": "Functional imaging of the exposed brain",
        "9927616": "\u5b9a\u91cf\u8840\u7ba1\u5185\u5149\u5b66\u76f8\u5e72\u5c42\u6790\u6210\u50cf\u7684\u7814\u7a76\u8fdb\u5c55",
        "9842008": "Deep learning-based optical coherence tomography image analysis of human brain cancer",
        "9468861": "Differentiation of different stages of brain tumor infiltration using optical coherence tomography: Comparison of two systems and histology",
        "9326400": "Highly Invasive Fluorescent/Bioluminescent Patient-Derived Orthotopic Model of Glioblastoma in Mice",
        "9045907": "Brain white matter morphological structure correlation with its optical properties estimated from optical coherence tomography (OCT) data",
        "9045891": "In vivo assessment of inflammatory bowel disease in rats with ultrahigh-resolution colonoscopic OCT",
        "8871129": "OCT-Guided Surgery for Gliomas: Current Concept and Future Perspectives",
        "8748995": "Scalable mapping of myelin and neuron density in the human brain with micrometer resolution",
        "8367274": "Minimizing OCT quantification error via a surface-tracking imaging probe",
        "8367221": "Speckle statistics of biological tissues in optical coherence tomography",
        "8354973": "Applying machine learning to optical coherence tomography images for automated tissue classification in brain metastases",
        "8278780": "Label-free detection of brain tumors in a 9L gliosarcoma rat model using stimulated Raman scattering-spectroscopic optical coherence tomography",
        "7687948": "Capability of physically reasonable OCT-based differentiation between intact brain tissues, human brain gliomas of different WHO grades, and glioma model 101.8 from rats",
        "7510870": "Deep learning architecture \u201cLightOCT\u201d for diagnostic decision support using optical coherence tomography images of biological samples",
        "7148106": "Theranostic OCT microneedle for fast ultrahigh-resolution deep-brain imaging and efficient laser ablation in vivo",
        "7118361": "Parametric imaging of attenuation by optical coherence tomography: review of models, methods, and clinical translation",
        "7041483": "Robust, accurate depth-resolved attenuation characterization in optical coherence tomography",
        "6997582": "Review of methods and applications of attenuation coefficient measurements with optical coherence tomography",
        "6977170": "Revealing brain pathologies with multimodal visible light optical coherence microscopy and fluorescence imaging",
        "6825537": "AI-Assisted In Situ Detection of Human Glioma Infiltration Using a Novel Computational Method for Optical Coherence Tomography",
        "6699388": "Molecular and Clinical Insights into the Invasive Capacity of Glioblastoma Cells",
        "6637128": "Speckle modulation enables high-resolution wide-field human brain tumor margin detection and in vivo murine neuroimaging",
        "6630098": "Optical coefficients as tools for increasing the optical coherence tomography contrast for normal brain visualization and glioblastoma detection",
        "6587169": "Laser brain cancer surgery in a xenograft model guided by optical coherence tomography",
        "6568186": "Dual-modality optical diagnosis for precise in vivo identification of tumors in neurosurgery",
        "6455095": "Cross-Polarization Optical Coherence Tomography for Brain Tumor Imaging",
        "6375924": "Quantitative nontumorous and tumorous human brain tissue assessment using microstructural co- and cross-polarized optical coherence tomography",
        "5894866": "High-speed optical coherence tomography by circular interferometric ranging",
        "5854071": "Investigation of tissue cellularity at the tip of the core biopsy needle with optical coherence tomography"
    },
    "journal": "Scientific Reports",
    "topics": [
        "algorithm, characterization, novel, cancer",
        "characterization, brain, robust, attenuation",
        "fast, using, attenuation, robust"
    ]
}